Common
===
ğŸ”™ [MENU README](./README.md)



# ç¶²å¡é¸è³¼
Kali Linuxå†æ‰¾å°‹é©åˆçš„ç¶²å¡é©…å‹•æ˜¯ååˆ†éº»ç…©çš„
æœ‰çš„ä¸èƒ½æ³¨å…¥ï¼Œæœ‰çš„ä¸èƒ½ç›£è½
ä»¥ä¸‹ä¸‰æ¬¾æ”¯æ´éš¨æ’å³ç”¨
1. Atheros AR9271 (ç¥å™¨)
2. Ralink RT3070
3. Realtek RTL818L


![](./_src/NetworkCard.png){:height="200px" width="400px"}

Function Test
```bash
iw list
# IBSS
# managed
# AP          ===> å¯ä»¥å½è£AP
# AP /VLAN
# monitor     ===> å¯ä»¥æŠ“åŒ…
# mesh point
# P2P-client
# P2P-GO
# outside context od a BSS


# æ³¨å…¥åŠŸèƒ½æ¸¬è©¦
sudo aireplay-ng -9 wlan0mon


Trying broadcast probe requests...  # ===> WEP Attack
Injection is working                # ===> å¯ä»¥æ³¨å…¥åŒ…

```
Card to Card Test
```bash
# ä¸€å€‹ç•¶AP ä¸€å€‹ç•¶Client
sudo aireplay-ng -9 -i wlan0mon wlan1mon


11:03:32  Trying broadcast probe requests...
11:03:32  Injection is working!
11:03:34  Found 1 AP 

11:03:34  Trying directed probe requests...
11:03:34  F0:9F:C2:AA:19:29 - channel: 1 - 'wifi-old'
11:03:34  Ping (min/avg/max): 0.232ms/4.545ms/15.496ms Power: -29.00
11:03:34  30/30: 100%


11:03:34  Trying card-to-card injection...
11:03:34  Attack -0:           OK
11:03:34  Attack -1 (open):    OK
11:03:34  Attack -1 (psk):     OK
11:03:34  Attack -2/-3/-4/-6:  OK
11:03:39  Attack -5/-7:        Failed
```
```
æ’å…¥ç¶²å¡å¾Œéœ€è¦å…ˆåŠ å…¥USB Controllerå†åŠ å…¥USBè£ç½®
```

---

# Common terms
```
AP    - Access Point
STA   - Stationç„¡ç·šå·¥ä½œç«™
SSID  - Service Set ID æœå‹™è­˜åˆ¥ç¢¼ï¼Œä¾¿æ–¼ç”¨æˆ¶è¾¨è­˜
BSSID - Basic Service Set ID åŸºç¤æœå‹™è­˜åˆ¥ç¢¼ï¼Œæœ¬è³ªæ˜¯APçš„MAC Address  
```

# Network Interface Mode
1. Ad-Hoc
    ç¯€é»äº’ç›¸é€£æ¥ï¼Œç„¡é ˆè·¯ç”±å™¨å³å¯å…±äº«è³‡æº(è·Ÿç¾åœ¨çš„WIFI-Directé¡ä¼¼)
2. Managed
    æœ€å¸¸ç”¨çš„æ¨¡å¼ï¼Œé€£æ¥åˆ°åŸºåœ°å°ï¼Œä¸¦åªæ¥å—è©²APçš„è³‡æ–™
3. Master
    å……ç•¶å­˜å–é»(ä¿—ç¨±åŸºåœ°å°)ï¼Œå…¶ä»–ç¯€é»å¯ä»¥é€£æ¥ï¼Œä¹Ÿå°±æ˜¯æˆ‘å€‘ä»Šæ—¥èªªçš„WIFIç†±é»
4. Monitor
    æ··äº‚æ¨¡å¼ï¼Œæ­¤æ¨¡å¼ä¸æœƒé€£æ¥åˆ°ä»»ä½•ç¯€é»æˆ–APï¼Œä½†å¯ä»¥ç›£æ§ç‰¹å®šç¯„åœä¸­çš„æ‰€æœ‰è³‡æ–™åŒ…


---

# Command
```bash
iwconfig           # åˆ—å‡ºç„¡ç·šç¶²å¡
iw wlan2 link      # æª¢æŸ¥é€£æ¥

sudo iw wlan2 scan # wlan2å¯ä»¥é€£æ¥å“ªäº›wifi
sudo iw wlan2 scan | grep SSID:
```
conf
```bash
# wpa_supplicant.conf

network={
    ssid="wifi-guest"
    key_mgmt=NONE
}
```
Connect WIFI
```bash
sudo wpa_supplicant -Dnl80211 -iwlan2 -c wpa_supplient.conf

# wpa_supplicant : ç”¨æ–¼é€£æ¥ WPA-PSK/WPA2-PSK åŠ å¯†çš„ Wi-Fi ç¶²çµ¡çš„å·¥å…·
# -D : æŒ‡å®šè¦ä½¿ç”¨çš„é©…å‹•ç¨‹åºé¡å‹
# -i : æŒ‡å®šè¦é…ç½®çš„ç„¡ç·šç¶²çµ¡ä»‹é¢
# -c : æŒ‡å®šé…ç½®æ–‡ä»¶çš„è·¯å¾‘
#      é…ç½®æ–‡ä»¶åŒ…å«è¦é€£æ¥çš„ç„¡ç·šç¶²çµ¡çš„è©³ç´°ä¿¡æ¯
#      å¦‚ SSIDã€å¯†ç¢¼ã€åŠ å¯†é¡å‹ç­‰


# å‡ºç¾ CTRL-EVENT-CONNECTED ä»£è¡¨æˆåŠŸé€£çµWIFI
Successfully initialized wpa_supplicant
wlan2: SME: Trying to authenticate with f0:9f:c2:71:22:10 (SSID='wifi-guest' freq=2437 MHz)
wlan2: Trying to associate with f0:9f:c2:71:22:10 (SSID='wifi-guest' freq=2437 MHz)
wlan2: Associated with f0:9f:c2:71:22:10
wlan2: CTRL-EVENT-CONNECTED - Connection to f0:9f:c2:71:22:10 completed [id=0 id_str=]
```
Get IP
```bash
sudo dhclient -v wlan2

# DHCPACK 192.168.10.84
DHCPACK of 192.168.10.84 from 192.168.10.1 (xid=0x3e18d051)
# è€Œæœ‰äº›ä¼æ¥­æœƒè¨­å®šä¸æ˜¯å…¬å¸å…§éƒ¨è¨»å†Šçš„MACï¼Œæœƒç„¡æ³•å–å¾—IPä»¥ä¿è³‡å®‰

# å¯ä»¥æ‰“é–‹ç€è¦½å™¨é€£çµ http://192.168.10.1
```

---

# Tool Study
1. Aircrack-ng
   - Monitoring
   - Attacking
   - Testing
   - Cracking
```bash
airmon-ng # ç¶²å¡è³‡è¨Š
```
Monitor Mode
```bash
# åˆ‡æ›æˆMonitor Modeæ¨¡å¼ å¦å‰‡æ˜¯æŠ“ä¸åˆ°ä»»ä½•å°åŒ…çš„
airmon-ng check  # æŸ¥çœ‹æœƒå½±éŸ¿Monitoræ¨¡å¼çš„Process
kill $id
service $service_name stop
airmon-ng check kill # ä¸Šé¢æª¢æ¸¬åˆ°çš„Processå…¨éƒ¨åˆªé™¤

airmon-ng start wlan0
airmon-ng stop  wlan0mon
ifconfig wlan0 up # åœç”¨monitoræ¨¡å¼å¾Œï¼Œç¶²å¡æœƒdownéœ€æ‰‹å‹•é–‹å•Ÿ

airmon-ng start wlan0 1 # é€²å…¥monitorä¸¦è™•æ–¼Channel 1
iwlist wlan0mon channel # æŸ¥çœ‹ç›®å‰æ˜¯åœ¨å“ªå€‹Channel
```
Function Test
```bash
aireplay-ng --help
# 0~9æœ‰ä¸åŒçš„åŠŸèƒ½

# æ³¨å…¥åŠŸèƒ½æ¸¬è©¦
aireplay-ng -9 wlan0mon
```
æŠ“åŒ…
```bash
airodump-ng wlan0mon

# BSSID  : AP çš„ MAC
# PWR    : RSSIç¶²å¡çš„æ¥å—ä¿¡è™Ÿå¼·åº¦æŒ‡ç¤º
# Beacons: æ¥æ”¶åˆ°æ­¤APç™¼é€çš„Beacon frame
# Data   : æŠ“åˆ°çš„Data frameæ•¸é‡
# #/s    : è¿‘10så…§æ¯ç§’å¹³å‡æŠ“åˆ°çš„frameæ•¸é‡
# CH     : Channelå¾Beacon frameä¸­ç²å¾—
# MB     : APæ”¯æŒçš„æœ€å¤§é€Ÿç‡
# ENC    : åŠ å¯†æ¼”ç®—æ³•é«”ç³»:WEPã€WPAã€WPA2ã€OPEN
# CIPHER : åŠ å¯†ç®—æ³•:CCMP(ç›®å‰æœ€å®‰å…¨çš„åŠ å¯†å¥—ä»¶)ã€TKIPã€WEP40ã€WEP104
# AUTH   : èº«åˆ†èªè­‰æ–¹å¼:MGTã€PSKã€SKA(WEPæœƒé¡¯ç¤º)ã€OPEN
# ESSID  : ç„¡ç·šç¶²è·¯åç¨±ï¼Œéš±è—APçš„è©±é€™å€‹å°±å¯èƒ½æ˜¯ç©º


airodump-ng wlan0mon -c 1

# RXQ    : æœ€è¿‘10sæˆåŠŸæ¥å—çš„frameç™¾åˆ†æ¯”ï¼Œåªæœ‰åœ¨å›ºå®šChannelæ™‚æ‰æœƒå‡ºç¾

# STATION: STAçš„MACåœ°å€
# Rate   : 0 APåˆ°å®¢æˆ¶ç«¯çš„æœ€å¾Œæ•¸æ“šé€Ÿç‡
#          1e å®¢æˆ¶ç«¯åˆ°APçš„æœ€å¾Œä¸€å€‹æ•¸æ“šé€Ÿç‡
# Lost   : ä¸Ÿå¤±çš„frameæ•¸é‡
# Frames : Clientç™¼é€çš„æ•¸æ“šåŒ…æ•¸é‡
# Probs  : å®¢æˆ¶ç«¯æ¢æ¸¬çš„ESSIDï¼Œè‹¥èƒ½çœ‹åˆ°probe frameä¸€èˆ¬ä¾†èªªå®¢æˆ¶è·é›¢æˆ‘å€‘ç„¡ç·šç¶²å¡éƒ½æŒºè¿‘çš„


airodump-ng wlan0mon -c 1 --bssid D4:EE:07:54:7B:90 -w cap_test.cap
wireshark cap_test.cap
```